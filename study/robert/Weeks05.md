## Ubuntu 22.04μ—μ„ ROS2μ™€ YOLOv8 μ—°λ™ μ„¤μΉ κ°€μ΄λ“

μ΄ κ°€μ΄λ“λ” Ubuntu 22.04 ν™κ²½μ—μ„ ROS2μ™€ ν•¨κ» YOLOv8μ„ μ„¤μΉν•κ³  μ—°λ™ν•λ” μƒμ„Έν• λ°©λ²•μ„ μ•λ‚΄ν•©λ‹λ‹¤. ROS2 Humble Hawksbillμ„ κΈ°μ¤€μΌλ΅ μ„¤λ…ν•λ©°, GPUλ¥Ό ν™μ©ν• κ°€μ†μ„ μ„ν•΄ NVIDIA λ“λΌμ΄λ²„, CUDA, cuDNNμ΄ μ‚¬μ „μ— μ„¤μΉλμ–΄ μλ‹¤κ³  κ°€μ •ν•©λ‹λ‹¤.

### 1. μ‚¬μ „ μ¤€λΉ„: ROS2 λ° κ°λ° λ„κµ¬ μ„¤μΉ

λ¨Όμ €, ROS2 Humbleκ³Ό κ°λ°μ— ν•„μ”ν• λ„κµ¬λ“¤μ΄ μ„¤μΉλμ–΄ μμ–΄μ•Ό ν•©λ‹λ‹¤.

- **ROS2 Humble μ„¤μΉ:** μ•„μ§ ROS2λ¥Ό μ„¤μΉν•μ§€ μ•μ•λ‹¤λ©΄, κ³µμ‹ λ¬Έμ„λ¥Ό μ°Έκ³ ν•μ—¬ μ„¤μΉλ¥Ό μ§„ν–‰ν•©λ‹λ‹¤. μΌλ°μ μΌλ΅ λ‹¤μ λ…λ Ήμ–΄λ¥Ό ν†µν•΄ λ°μ¤ν¬ν†± λ²„μ „μ„ μ„¤μΉν•©λ‹λ‹¤.
    
    ```bash
    sudo apt update && sudo apt install ros-humble-desktop
    ```
    
- **Colcon λ° κ°λ° λ„κµ¬ μ„¤μΉ:** ROS2 ν¨ν‚¤μ§€ λΉλ“λ¥Ό μ„ν• `colcon`κ³Ό κΈ°νƒ€ κ°λ° λ„κµ¬λ“¤μ„ μ„¤μΉν•©λ‹λ‹¤.
    
    ```bash
    sudo apt install ros-dev-tools
    ```
    

### 2. YOLOv8 ROS2 ν¨ν‚¤μ§€ μ„¤μΉ

YOLOv8μ„ ROS2μ™€ μ‰½κ² μ—°λ™ν•κΈ° μ„ν•΄ κ³µκ°λ ROS2 ν¨ν‚¤μ§€λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ΄ νΈλ¦¬ν•©λ‹λ‹¤. μ—¬κΈ°μ„λ” `yolov8_ros` ν¨ν‚¤μ§€λ¥Ό μμ‹λ΅ μ‚¬μ©ν•©λ‹λ‹¤.

- **ROS2 μ‘μ—… κ³µκ°„ μƒμ„±:** ν¨ν‚¤μ§€λ¥Ό λΉλ“ν•  μ‘μ—… κ³µκ°„(workspace)μ„ μƒμ„±ν•©λ‹λ‹¤.
    
    ```bash
    mkdir -p ~/ros2_ws/src
    cd ~/ros2_ws/src
    ```
    
- **`yolov8_ros` ν¨ν‚¤μ§€ ν΄λ΅ :** GitHubμ—μ„ `yolov8_ros` ν¨ν‚¤μ§€ μ†μ¤ μ½”λ“λ¥Ό ν΄λ΅ ν•©λ‹λ‹¤.
    
    ```bash
    git clone https://github.com/mgonzs13/yolov8_ros.git
    ```
    
- **μμ΅΄μ„± ν¨ν‚¤μ§€ μ„¤μΉ:** `yolov8_ros` ν¨ν‚¤μ§€κ°€ ν•„μ”λ΅ ν•λ” νμ΄μ¬ λΌμ΄λΈλ¬λ¦¬λ“¤μ„ `requirements.txt` νμΌμ„ μ΄μ©ν•μ—¬ μ„¤μΉν•©λ‹λ‹¤.
    
    ```bash
    cd ~/ros2_ws/src/yolov8_ros
    pip install -r requirements.txt
    ```
    
    > **μ°Έκ³ :** `requirements.txt` νμΌμ—λ” `ultralytics` (YOLOv8), `torch`, `torchvision` λ“± ν•„μ λΌμ΄λΈλ¬λ¦¬λ“¤μ΄ ν¬ν•¨λμ–΄ μμµλ‹λ‹¤.
    > 

### 3. λΉλ“ λ° ν™κ²½ μ„¤μ •

μ΄μ  λ‹¤μ΄λ΅λ“ν• ROS2 ν¨ν‚¤μ§€λ¥Ό λΉλ“ν•κ³  μ‹¤ν–‰ ν™κ²½μ„ μ„¤μ •ν•©λ‹λ‹¤.

- **ColconμΌλ΅ λΉλ“:** μ‘μ—… κ³µκ°„μ μµμƒμ„ λ””λ ‰ν† λ¦¬λ΅ μ΄λ™ν•μ—¬ `colcon build` λ…λ Ήμ„ μ‹¤ν–‰ν•©λ‹λ‹¤.
    
    ```bash
    cd ~/ros2_ws
    colcon build
    ```
    
    λΉλ“ κ³Όμ •μ—μ„ μ¤λ¥κ°€ λ°μƒν•  κ²½μ°, μμ΅΄μ„± ν¨ν‚¤μ§€κ°€ μ¬λ°”λ¥΄κ² μ„¤μΉλμ—λ”μ§€, μ‹μ¤ν…μ— ν•„μ”ν• λΌμ΄λΈλ¬λ¦¬(μ: `python3-opencv`)κ°€ λ¨λ‘ μ„¤μΉλμ–΄ μλ”μ§€ ν™•μΈν•λ” κ²ƒμ΄ μΆ‹μµλ‹λ‹¤.
    
- **ν™κ²½ μ„¤μ • μ¤ν¬λ¦½νΈ μ μ©:** λΉλ“κ°€ μ„±κ³µμ μΌλ΅ μ™„λ£λλ©΄, μƒμ„±λ μ„¤μ • νμΌμ„ ν„°λ―Έλ„μ— μ μ©ν•΄μ•Ό ν•©λ‹λ‹¤.
    
    ```bash
    source ~/ros2_ws/install/setup.bash
    ```
    
    λ§¤λ² μƒ ν„°λ―Έλ„μ„ μ—΄ λ•λ§λ‹¤ μ΄ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•κ±°λ‚, `~/.bashrc` νμΌμ— μ¶”κ°€ν•μ—¬ μλ™μΌλ΅ μ μ©λκ² ν•  μ μμµλ‹λ‹¤.
    
    ```bash
    echo "source ~/ros2_ws/install/setup.bash" >> ~/.bashrc
    source ~/.bashrc
    ```
    

### 4. μ‹¤ν–‰ λ° ν…μ¤νΈ

λ¨λ“  μ„¤μΉκ°€ μ™„λ£λμ—λ‹¤λ©΄, μ›ΉμΊ μ΄λ‚ λ™μμƒ νμΌμ„ μ΄μ©ν•μ—¬ YOLOv8 ROS2 λ…Έλ“λ¥Ό μ‹¤ν–‰ν•κ³  κ°μ²΄ νƒμ§€ κ²°κ³Όλ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.

- **μΉ΄λ©”λΌ λ…Έλ“ μ‹¤ν–‰ (μμ‹):** λ¨Όμ € μΉ΄λ©”λΌ μμƒμ„ ROS2 ν† ν”½μΌλ΅ κ²μ‹(publish)ν•λ” λ…Έλ“λ¥Ό μ‹¤ν–‰ν•΄μ•Ό ν•©λ‹λ‹¤. `usb_cam` ν¨ν‚¤μ§€λ‚ μ‹μ¤ν…μ— λ§λ” μΉ΄λ©”λΌ λ“λΌμ΄λ²„ λ…Έλ“λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤. `usb_cam` ν¨ν‚¤μ§€κ°€ μ„¤μΉλμ–΄ μμ§€ μ•λ‹¤λ©΄ λ‹¤μ λ…λ Ήμ–΄λ΅ μ„¤μΉν•  μ μμµλ‹λ‹¤.
    
    ```bash
    sudo apt install ros-humble-usb-cam
    ```
    
    μΉ΄λ©”λΌ λ…Έλ“λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.
    
    ```bash
    ros2 launch usb_cam camera.launch.py
    ```
    
λ…ΈνΈλ¶ μΉ΄λ©”λΌλ¥Ό μ‚¬μ©ν•  λ•λ” usb_cam ν¨ν‚¤μ§€μ μ„¤μ •μ„ μ΅°μ •ν•΄μ•Ό ν•©λ‹λ‹¤. λ…ΈνΈλ¶ μΉ΄λ©”λΌλ” λ³΄ν†µ /dev/video0 λλ” /dev/video1μ— μ—°κ²°λμ–΄ μμµλ‹λ‹¤.   
- λ…ΈνΈλ¶ μΉ΄λ©”λΌκ°€ /dev/video0μ— μλ‹¤λ©΄:
```bash
ros2 launch usb_cam camera.launch.py video_device:=/dev/video0
```

- λ…ΈνΈλ¶ μΉ΄λ©”λΌμ μ„±λ¥μ— λ§κ² ν•΄μƒλ„μ™€ ν”„λ μ„λ μ΄νΈλ¥Ό μ΅°μ •ν•  μ μμµλ‹λ‹¤:
```bash
ros2 launch usb_cam camera.launch.py video_device:=/dev/video0 image_width:=640 image_height:=480 framerate:=30
```

- μ‚¬μ© κ°€λ¥ν• λΉ„λ””μ¤ λ””λ°”μ΄μ¤ ν™•μΈ
```bash
ls /dev/video*
```

- μΉ΄λ©”λΌ μ •λ³΄ ν™•μΈ
```bash
v4l2-ctl --device=/dev/video0 --list-formats-ext
```

- μΉ΄λ©”λΌ κ¶ν• λ¬Έμ  ν•΄κ²°
```bash
sudo usermod -a -G video $USER
```


- **YOLOv8 λ…Έλ“ μ‹¤ν–‰:** μ΄μ  `yolov8_ros` ν¨ν‚¤μ§€μ launch νμΌμ„ μ‹¤ν–‰ν•μ—¬ κ°μ²΄ νƒμ§€λ¥Ό μ‹μ‘ν•©λ‹λ‹¤. μ΄ launch νμΌμ€ μΉ΄λ©”λΌ ν† ν”½μ„ μ…λ ¥μΌλ΅ λ°›μ•„ νƒμ§€ κ²°κ³Όλ¥Ό μ΄λ―Έμ§€μ™€ ν† ν”½μΌλ΅ μ¶λ ¥ν•©λ‹λ‹¤.
    
    ```bash
    ros2 launch yolov8_bringup yolov8.launch.py
    ```
    
    **μ°Έκ³ :** λ§μ•½ λ‹¤λ¥Έ μΉ΄λ©”λΌ ν† ν”½μ„ μ‚¬μ©ν•λ‹¤λ©΄, launch νμΌμ νλΌλ―Έν„°λ¥Ό μμ •ν•΄μ•Ό ν•  μ μμµλ‹λ‹¤. μλ¥Ό λ“¤μ–΄, μ…λ ¥ μ΄λ―Έμ§€ ν† ν”½μ„ λ³€κ²½ν•λ ¤λ©΄ λ‹¤μκ³Ό κ°™μ΄ μ‹¤ν–‰ν•©λ‹λ‹¤.
    
    ```bash
    ros2 launch yolov8_bringup yolov8.launch.py input_image_topic:=/my_camera/image_raw
    ```
    
- **κ²°κ³Ό ν™•μΈ:** `rviz2`λ‚ `rqt_image_view`λ¥Ό μ‚¬μ©ν•μ—¬ νƒμ§€ κ²°κ³Όκ°€ ν‘μ‹λ μ΄λ―Έμ§€λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.
    
    ```bash
    # νƒμ§€ κ²°κ³Ό μ΄λ―Έμ§€λ¥Ό rqt_image_viewλ΅ ν™•μΈ
    rqt_image_view /yolo/image_raw
    
    # νƒμ§€λ κ°μ²΄ μ •λ³΄λ¥Ό ν† ν”½μΌλ΅ ν™•μΈ
    ros2 topic echo /yolo/detections
    ```
    

μ΄μ  μ—¬λ¬λ¶„μ ROS2 ν”„λ΅μ νΈμ—μ„ YOLOv8μ„ ν™μ©ν• μ‹¤μ‹κ°„ κ°μ²΄ νƒμ§€ κΈ°λ¥μ„ μ‚¬μ©ν•  μ μμµλ‹λ‹¤. π‰